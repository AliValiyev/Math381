%diary_test
%diary_test
hilb(3)

ans =

    1.0000    0.5000    0.3333
    0.5000    0.3333    0.2500
    0.3333    0.2500    0.2000

exer6
A

A =

    1.0000    0.5000    0.3333    0.2500    0.2000
    0.5000    0.3333    0.2500    0.2000    0.1667
    0.3333    0.2500    0.2000    0.1667    0.1429
    0.2500    0.2000    0.1667    0.1429    0.1250
    0.2000    0.1667    0.1429    0.1250    0.1111

U

U =

    1.0000    0.5000    0.3333    0.2500    0.2000
         0    0.0833    0.0833    0.0750    0.0667
         0    0.0833    0.0889    0.0833    0.0762
         0    0.0750    0.0833    0.0804    0.0750
         0    0.0667    0.0762    0.0750    0.0711

L

L =

    1.0000         0         0         0         0
    0.5000    1.0000         0         0         0
    0.3333         0    1.0000         0         0
    0.2500         0         0    1.0000         0
    0.2000         0         0         0    1.0000

U*L

ans =

    1.4636    0.5000    0.3333    0.2500    0.2000
    0.1015    0.0833    0.0833    0.0750    0.0667
    0.1074    0.0833    0.0889    0.0833    0.0762
    0.1004    0.0750    0.0833    0.0804    0.0750
    0.0917    0.0667    0.0762    0.0750    0.0711

L*U

ans =

    1.0000    0.5000    0.3333    0.2500    0.2000
    0.5000    0.3333    0.2500    0.2000    0.1667
    0.3333    0.2500    0.2000    0.1667    0.1429
    0.2500    0.2000    0.1667    0.1429    0.1250
    0.2000    0.1667    0.1429    0.1250    0.1111

A = L*U

A =

    1.0000    0.5000    0.3333    0.2500    0.2000
    0.5000    0.3333    0.2500    0.2000    0.1667
    0.3333    0.2500    0.2000    0.1667    0.1429
    0.2500    0.2000    0.1667    0.1429    0.1250
    0.2000    0.1667    0.1429    0.1250    0.1111

A == L*U

ans =

  5×5 <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a> array

   1   1   1   1   1
   1   1   1   1   1
   1   1   1   1   1
   1   1   1   1   1
   1   1   1   1   1

exer6
A == L*U

ans =

  5×5 <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a> array

   1   1   1   1   1
   1   1   1   1   1
   1   1   1   1   1
   1   1   1   1   1
   1   1   1   1   1

U

U =

    1.0000    0.5000    0.3333    0.2500    0.2000
         0    0.0833    0.0833    0.0750    0.0667
         0    0.0833    0.0889    0.0833    0.0762
         0    0.0750    0.0833    0.0804    0.0750
         0    0.0667    0.0762    0.0750    0.0711

L

L =

    1.0000         0         0         0         0
    0.5000    1.0000         0         0         0
    0.3333         0    1.0000         0         0
    0.2500         0         0    1.0000         0
    0.2000         0         0         0    1.0000

norm(L*U-A,'fro')/norm(A,'fro')

ans =

     0

gauss_lu
gauss_lu(A)
gauss_lu(A)

ans =

    1.0000         0         0         0         0
    0.5000    1.0000         0         0         0
    0.3333    1.0000    1.0000         0         0
    0.2500    0.9000    1.5000    1.0000         0
    0.2000    0.8000    1.7143    2.0000    1.0000

[L,U] = gauss_lu(A)

L =

    1.0000         0         0         0         0
    0.5000    1.0000         0         0         0
    0.3333    1.0000    1.0000         0         0
    0.2500    0.9000    1.5000    1.0000         0
    0.2000    0.8000    1.7143    2.0000    1.0000


U =

    1.0000    0.5000    0.3333    0.2500    0.2000
         0    0.0833    0.0833    0.0750    0.0667
         0   -0.0000    0.0056    0.0083    0.0095
         0         0         0    0.0004    0.0007
         0         0         0         0    0.0000


L*U == A

ans =

  5×5 <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a> array

   1   1   1   1   1
   1   1   1   1   1
   1   1   1   0   1
   1   0   0   1   1
   1   0   1   1   1

norm(L*U-A,'fro')/norm(A,'fro')

ans =

   3.5113e-17

format long
[L,U] = gauss_lu(A)

L =

   1.000000000000000                   0                   0                   0                   0
   0.500000000000000   1.000000000000000                   0                   0                   0
   0.333333333333333   1.000000000000000   1.000000000000000                   0                   0
   0.250000000000000   0.900000000000000   1.500000000000001   1.000000000000000                   0
   0.200000000000000   0.800000000000000   1.714285714285721   1.999999999999927   1.000000000000000


U =

   1.000000000000000   0.500000000000000   0.333333333333333   0.250000000000000   0.200000000000000
                   0   0.083333333333333   0.083333333333333   0.075000000000000   0.066666666666667
                   0  -0.000000000000000   0.005555555555556   0.008333333333333   0.009523809523810
                   0   0.000000000000000                   0   0.000357142857143   0.000714285714286
                   0  -0.000000000000000                   0                   0   0.000022675736961

lu(A)

ans =

   1.000000000000000   0.500000000000000   0.333333333333333   0.250000000000000   0.200000000000000
   0.333333333333333   0.083333333333333   0.088888888888889   0.083333333333333   0.076190476190476
   0.500000000000000   1.000000000000000  -0.005555555555556  -0.008333333333333  -0.009523809523810
   0.200000000000000   0.800000000000000  -0.914285714285719   0.000714285714286   0.001451247165533
   0.250000000000000   0.900000000000000  -0.599999999999998   0.500000000000030  -0.000011337868481

[L_test, U_test] = lu(A)

L_test =

   1.000000000000000                   0                   0                   0                   0
   0.500000000000000   1.000000000000000   1.000000000000000                   0                   0
   0.333333333333333   1.000000000000000                   0                   0                   0
   0.250000000000000   0.900000000000000  -0.599999999999998   0.500000000000030   1.000000000000000
   0.200000000000000   0.800000000000000  -0.914285714285719   1.000000000000000                   0


U_test =

   1.000000000000000   0.500000000000000   0.333333333333333   0.250000000000000   0.200000000000000
                   0   0.083333333333333   0.088888888888889   0.083333333333333   0.076190476190476
                   0                   0  -0.005555555555556  -0.008333333333333  -0.009523809523810
                   0                   0                   0   0.000714285714286   0.001451247165533
                   0                   0                   0                   0  -0.000011337868481

[L_test, U_test] = lu(L)

L_test =

   1.000000000000000                   0                   0                   0                   0
   0.500000000000000   1.000000000000000   1.000000000000000                   0                   0
   0.333333333333333   1.000000000000000                   0                   0                   0
   0.250000000000000   0.900000000000000  -0.600000000000002   0.500000000000018   1.000000000000000
   0.200000000000000   0.800000000000000  -0.914285714285722   1.000000000000000                   0


U_test =

   1.000000000000000                   0                   0                   0                   0
                   0   1.000000000000000   1.000000000000000                   0                   0
                   0                   0  -1.000000000000000                   0                   0
                   0                   0                   0   1.999999999999927   1.000000000000000
                   0                   0                   0                   0  -0.500000000000018

[L,U] = gauss_lu(hilb(5))

L =

   1.000000000000000                   0                   0                   0                   0
   0.500000000000000   1.000000000000000                   0                   0                   0
   0.333333333333333   1.000000000000000   1.000000000000000                   0                   0
   0.250000000000000   0.900000000000000   1.500000000000001   1.000000000000000                   0
   0.200000000000000   0.800000000000000   1.714285714285721   1.999999999999927   1.000000000000000


U =

   1.000000000000000   0.500000000000000   0.333333333333333   0.250000000000000   0.200000000000000
                   0   0.083333333333333   0.083333333333333   0.075000000000000   0.066666666666667
                   0  -0.000000000000000   0.005555555555556   0.008333333333333   0.009523809523810
                   0   0.000000000000000                   0   0.000357142857143   0.000714285714286
                   0  -0.000000000000000                   0                   0   0.000022675736961

U(5,5)

ans =

     2.267573696146385e-05

L*U == hilb(5)

ans =

  5×5 <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a> array

   1   1   1   1   1
   1   1   1   1   1
   1   1   1   0   1
   1   1   0   1   1
   1   0   1   1   1

norm(L*U-A,'fro')/norm(A,'fro')

ans =

     3.040918255335998e-17

R = rand(100,100);
[LR,UR] = gauss_lu(R);
norm(LR*UR-R,'fro')/norm(R,'fro')

ans =

     1.522975373348136e-14

istril(LR)

ans =

  <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a>

   1

istriu(UR)

ans =

  <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a>

   0

istriu(U)

ans =

  <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a>

   0

istril(L)

ans =

  <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a>

   1

diary off
